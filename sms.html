function sendSMS(timeRange) {
    const urlParams = new URLSearchParams(window.location.search);
    let tel = urlParams.get("tel");

    if (!tel) {
        alert("Phone number is missing!");
        return;
    }

    let message = timeRange ? `I am on my way and should be there ${timeRange}. -LG Direct Service Technician` : '';

    try {
        // Attempt using the sms: URL first
        const smsUrl = message 
            ? `sms:${encodeURIComponent(tel)}?body=${encodeURIComponent(message)}`
            : `sms:${encodeURIComponent(tel)}`;

        window.location.href = smsUrl;

        setTimeout(() => {
            // If the sms: fails, try the intent URL
            const intentUrl = message
                ? `intent://send/${tel}#Intent;scheme=smsto;package=com.google.android.apps.messaging;S.android.intent.extra.TEXT=${encodeURIComponent(message)};end`
                : `intent://send/${tel}#Intent;scheme=smsto;package=com.google.android.apps.messaging;end`;

            window.location.href = intentUrl;
        }, 1000);
    } catch (error) {
        console.error('Error sending SMS:', error);
        alert('Unable to open Messenger. Please check your settings.');
    }

    // Attempt to minimize or close the browser window
    setTimeout(() => {
        if (window.AndroidInterface && window.AndroidInterface.closeWindow) {
            window.AndroidInterface.closeWindow();
        } else {
            window.blur();
            window.open('', '_self', '');
            window.close();
        }
    }, 1500);
}
